import lightgbm as lgb

# Initial training on N10 + B30 Pro
train_data = lgb.Dataset(X_train, label=y_train)
params = {
    'objective': 'binary',
    'metric': 'auc',
    'learning_rate': 0.05,
    'num_leaves': 31,
    'feature_pre_filter': False  # important if optional features may be missing
}

model = lgb.train(params, train_data, num_boost_round=100)

# Save memory buffer from training data
memory_buffer_X = X_train.sample(500)
memory_buffer_y = y_train.loc[memory_buffer_X.index]

# Incremental update with a new sheet (Data Before Feb 13)
X_new, y_new = preprocess_new_sheet(df_new)  # function that aligns columns to master list

# Combine buffer + new sheet
X_update = pd.concat([memory_buffer_X, X_new])
y_update = pd.concat([memory_buffer_y, y_new])

update_data = lgb.Dataset(X_update, label=y_update)
model = lgb.train(params, update_data, num_boost_round=50, init_model=model)
